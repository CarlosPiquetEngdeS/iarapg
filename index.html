<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MÉDIA PONDERADA</title>

    <style>
        body,
        .form-container,
        .obs-container textarea,
        .subject input[type="text"] {
            word-wrap: break-word;
            word-break: break-all;
        }

        body {
            font-family: Arial, sans-serif;
            background: url('02.png') no-repeat center center fixed;
            background-size: cover;
            margin: 0;
            padding: 50px;
            display: flex;
            flex-direction: column;
            min-height: 70vh;
        }

        .form-container {
            max-width: 600px;
            font-size: 15px;
            color: #cac9c9;
            margin: 0 auto;
            background-color: rgba(8, 8, 8, 0.8);
            /* Leve transparência */
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 0px 20px rgba(255, 255, 255, 0.5);
            /* Transparência no box-shadow */
            flex: 1;
        }

        .form-container label {
            display: block;
            margin-bottom: 10px;
            font-weight: bold;
        }

        .form-container input[type="number"],
        .form-container input[type="text"],
        .form-container select {
            width: 80%;
            padding: 12px;
            border: 2px solid #2649bb;
            border-radius: 10px;
            font-size: 16px;
            -moz-appearance: textfield;
        }

        .form-container input[type="number"]::-webkit-outer-spin-button,
        .form-container input[type="number"]::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        .form-container .subject {
            margin-bottom: 20px;
        }

        .form-container .subject input[type="number"],
        .form-container .subject input[type="text"],
        .form-container .subject select {
            width: 200px;
            display: inline-block;
            margin-right: 2%;
        }

        .form-container button {
            display: block;
            width: 70%;
            padding: 12px;
            background-color: #2649bb;
            color: #ffffff;
            border: none;
            border-radius: 10px;
            font-size: 15px;
            cursor: pointer;
            margin-top: 10px;
            text-transform: uppercase;
            transition: background-color 0.3s ease;
        }

        .form-container button:hover {
            background-color: #45a049;
            /* Cor de hover */
        }

        #result {
            margin-top: 20px;
            font-size: 18px;
            font-weight: bold;
            display: none;
        }

        #tccFields,
        #obsField,
        #tccWeightField,
        #tccResultField {
            display: none;
        }

        .rodape-flutuante {
            font-size: 15px;
            color: #ffffff;
            padding: 10px;
            border-radius: 5px;
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
            transition: transform 0.3s, box-shadow 0.3s;
            animation: flutuar 3s ease-in-out infinite;
            margin-top: auto;
        }

        .calculator-type {
            margin-bottom: 20px;
        }

        .obs-container {
            position: relative;
            margin-bottom: 10px;
        }

        .obs-container textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #2649bb;
            border-radius: 10px;
            font-size: 16px;
            min-height: 100px;
        }

        .obs-container button {
            display: inline-block;
            width: 60%;
            padding: 10px;
            background-color: #2649bb;
            color: #ffffff;
            border: none;
            border-radius: 10px;
            font-size: 15px;
            cursor: pointer;
            margin-top: 10px;
            text-transform: uppercase;
        }

        .image-container {
            position: relative;
            margin-top: 20px;
        }

        .image-container input[type="file"] {
            display: none;
        }

        .image-container label {
            font-weight: bold;
            cursor: pointer;
            display: block;
            margin-bottom: 15px;
            padding: 10px;
            background-color: #bbb826;
            color: #131313;
            border: none;
            border-radius: 10px;
            font-size: 12px;
            text-align: center;
            text-transform: uppercase;
            width: 50%;
        }

        .image-container label:hover {
            background-color: #45a049;
        }

        .image-preview {
            max-width: 100px;
            max-height: 100px;
            display: block;
            margin-top: 10px;
        }

        h1 {
            font-size: 25px;
            text-align: center;
        }

        .turma {
            width: 100%;
            padding: 12px;
            border: 2px solid #2649bb;
            border-radius: 10px;
            font-size: 16px;
            margin-bottom: 20px;
        }

        .nota {
            width: 50px;
        }

        .peso {
            width: 50px;
        }

        .tcc-grades {
            display: flex;
            justify-content: space-between;
        }

        .tcc-grades input {
            width: 70px;
        }

        #numSubjects {
            width: 50px;
            /* Ajuste a largura do campo Número de Matérias */
        }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script>
        let savedObservations = "";

        function createSubjectFields(numSubjects) {
            const subjectsContainer = document.getElementById('subjectsContainer');
            subjectsContainer.innerHTML = "";

            const subjectOptions = [
                "Teoria do Direito",
                "Princípios Institucionais da Advocacia de Estado",
                "Novas Tendências em Direito Constitucional",
                "Novas Tendências em Direito Administrativo",
                "Gestão Pública e Advocacia de Estado",
                "Assessoria e Consultoria Jurídica em Projetos de Infraestrutura",
                "Direito e Políticas Públicas",
                "Direito Ambiental e Sustentabilidade",
                "Advocacia Pública Fiscal e Tributária",
                "Sistemas de Integridade Pública e Privada",
                "Contratos Administrativos e Responsabilidade Civil do Estado",
                "Fazenda Pública em Juízo",
                "Métodos Extrajudiciais de Resolução de Conflitos",
                "Relações Contratuais de Trabalho na Administração Pública",
                "Regime Jurídico dos Servidores Públicos",
                "Regime Previdenciário dos Servidores Públicos",
                "Defesa de Políticas Públicas em Juízo",
                "Metodologia",
            ];

            for (let i = 1; i <= numSubjects; i++) {
                const subjectDiv = document.createElement('div');
                subjectDiv.className = 'subject';

                const subjectSelect = document.createElement('select');
                subjectSelect.id = `subjectName${i}`;
                const defaultOption = document.createElement('option');
                defaultOption.value = "";
                defaultOption.text = `Escolha a Matéria ${i} ou Digite`;
                subjectSelect.appendChild(defaultOption);

                subjectOptions.forEach(subject => {
                    const option = document.createElement('option');
                    option.value = subject;
                    option.text = subject;
                    subjectSelect.appendChild(option);
                });

                subjectSelect.onchange = function () {
                    const otherInput = document.getElementById(`subjectNameOther${i}`);
                    if (subjectSelect.value === "") {
                        otherInput.style.display = 'inline-block';
                    } else {
                        otherInput.style.display = 'none';
                    }
                };
                subjectDiv.appendChild(subjectSelect);

                const subjectNameInput = document.createElement('input');
                subjectNameInput.type = 'text';
                subjectNameInput.placeholder = `Outra Matéria ${i}`;
                subjectNameInput.id = `subjectNameOther${i}`;
                subjectNameInput.style.display = 'none';
                subjectDiv.appendChild(subjectNameInput);

                const gradeInput = document.createElement('input');
                gradeInput.type = 'number';
                gradeInput.step = '0.1';
                gradeInput.placeholder = 'Nota';
                gradeInput.id = `grade${i}`;
                gradeInput.className = 'nota';
                subjectDiv.appendChild(gradeInput);

                const weightInput = document.createElement('input');
                weightInput.type = 'number';
                weightInput.step = '0.1';
                weightInput.placeholder = 'Peso';
                weightInput.id = `weight${i}`;
                weightInput.className = 'peso';
                subjectDiv.appendChild(weight);

                subjectsContainer.appendChild(subjectDiv);
            }
        }

        function calculateAverage() {
            const numSubjects = document.getElementById('numSubjects').value;
            let totalGrade = 0;
            let totalWeight = 0;

            for (let i = 1; i <= numSubjects; i++) {
                const subjectSelect = document.getElementById(`subjectName${i}`);
                const subjectNameOther = document.getElementById(`subjectNameOther${i}`);
                const subjectName = subjectSelect.value || subjectNameOther.value;

                const grade = parseFloat(document.getElementById(`grade${i}`).value);
                const weight = parseFloat(document.getElementById(`weight${i}`).value);

                if (!isNaN(grade) && !isNaN(weight)) {
                    totalGrade += grade * weight;
                    totalWeight += weight;
                }
            }

            const average = totalWeight === 0 ? 0 : (totalGrade / totalWeight).toFixed(2);
            document.getElementById('result').innerText = `Média Ponderada: ${average}`;
            document.getElementById('result').style.display = 'block';
        }

        function toggleFields() {
            const calculatorType = document.querySelector('input[name="calculatorType"]:checked').value;
            const tccFields = document.getElementById('tccFields');
            const obsField = document.getElementById('obsField');
            const tccWeightField = document.getElementById('tccWeightField');

            if (calculatorType === 'tcc') {
                tccFields.style.display = 'block';
                obsField.style.display = 'none';
                tccWeightField.style.display = 'block';
            } else if (calculatorType === 'observacao') {
                obsField.style.display = 'block';
                tccFields.style.display = 'none';
                tccWeightField.style.display = 'none';
            } else {
                tccFields.style.display = 'none';
                obsField.style.display = 'none';
                tccWeightField.style.display = 'none';
            }
        }

        function saveObservation() {
            const observation = document.getElementById('observation').value;
            savedObservations += observation + "\n";
            document.getElementById('savedObservations').innerText = savedObservations;
        }

        function previewImage(event) {
            const reader = new FileReader();
            reader.onload = function () {
                const imagePreview = document.getElementById('imagePreview');
                imagePreview.src = reader.result;
                imagePreview.style.display = 'block';
            }
            reader.readAsDataURL(event.target.files[0]);
        }

        function exportToPDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();

            let yOffset = 10;

            const title = "Relatório de Média Ponderada";
            doc.setFontSize(18);
            doc.text(title, 105, yOffset, { align: "center" });
            yOffset += 10;

            const numSubjects = document.getElementById('numSubjects').value;

            for (let i = 1; i <= numSubjects; i++) {
                const subjectSelect = document.getElementById(`subjectName${i}`);
                const subjectNameOther = document.getElementById(`subjectNameOther${i}`);
                const subjectName = subjectSelect.value || subjectNameOther.value;

                const grade = document.getElementById(`grade${i}`).value;
                const weight = document.getElementById(`weight${i}`).value;

                doc.setFontSize(12);
                doc.text(`Matéria ${i}: ${subjectName}`, 10, yOffset);
                yOffset += 6;
                doc.text(`Nota: ${grade}, Peso: ${weight}`, 10, yOffset);
                yOffset += 10;
            }

            const average = document.getElementById('result').innerText;
            doc.setFontSize(14);
            doc.text(average, 10, yOffset);

            const observation = document.getElementById('savedObservations').innerText;
            yOffset += 10;
            doc.text("Observações:", 10, yOffset);
            yOffset += 6;
            doc.setFontSize(12);
            doc.text(observation, 10, yOffset);

            doc.save("relatorio.pdf");
        }
    </script>
</head>

<body>
    <div class="form-container">
        <h1>Calculadora de Média Ponderada</h1>
        <div class="calculator-type">
            <label><input type="radio" name="calculatorType" value="normal" onclick="toggleFields()"> Normal</label>
            <label><input type="radio" name="calculatorType" value="tcc" onclick="toggleFields()"> TCC</label>
            <label><input type="radio" name="calculatorType" value="observacao" onclick="toggleFields()"> Observação</label>
        </div>

        <div class="turma">
            <label for="numSubjects">Número de Matérias:</label>
            <input type="number" id="numSubjects" oninput="createSubjectFields(this.value)">
        </div>

        <div id="subjectsContainer"></div>

        <div id="tccFields">
            <div class="tcc-grades">
                <label for="tccScore">Nota TCC:</label>
                <input type="number" id="tccScore" step="0.1">
            </div>
            <div id="tccWeightField">
                <label for="tccWeight">Peso TCC:</label>
                <input type="number" id="tccWeight" step="0.1">
            </div>
        </div>

        <div id="obsField">
            <div class="obs-container">
                <textarea id="observation" placeholder="Digite suas observações..."></textarea>
                <button type="button" onclick="saveObservation()">Salvar Observação</button>
            </div>
            <p>Observações Salvas:</p>
            <pre id="savedObservations"></pre>
        </div>

        <button type="button" onclick="calculateAverage()">Calcular Média</button>
        <div id="result"></div>

        <div class="image-container">
            <label for="fileInput">Carregar Imagem:</label>
            <input type="file" id="fileInput" accept="image/*" onchange="previewImage(event)">
            <img id="imagePreview" class="image-preview" alt="Pré-visualização da Imagem" style="display:none;">
        </div>

        <button type="button" onclick="exportToPDF()">Exportar para PDF</button>
    </div>

    <div class="rodape-flutuante">
        Carlos Antonio Oliveira Piquet
    </div>
</body>

</html>